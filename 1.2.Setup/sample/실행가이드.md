# 실행 가이드

이 문서는 샘플 프로젝트를 실행하는 상세한 단계별 가이드를 제공합니다.

## 📋 사전 준비사항 체크리스트

실행 전에 다음이 준비되어 있는지 확인하세요:

- [ ] JDK 17 이상 설치됨 (`java -version` 확인)
- [ ] Gradle 또는 Maven 설치됨
- [ ] IDE (IntelliJ IDEA 또는 VS Code) 설치됨
- [ ] OpenAI API Key 발급됨 (또는 다른 LLM 서비스 API Key)

---

## 🎯 방법 1: IntelliJ IDEA에서 실행 (권장)

### 단계 1: 프로젝트 열기

1. IntelliJ IDEA 실행
2. `File` → `Open`
3. `sample` 디렉토리 선택
4. "Trust Project" 클릭

### 단계 2: 프로젝트 동기화

1. Gradle 창이 열리면 "Sync Now" 클릭
2. 또는 `View` → `Tool Windows` → `Gradle`

### 단계 3: 환경 변수 설정

**방법 A: Run Configuration에서 설정**

1. `Run` → `Edit Configurations...`
2. `SpringAiAppApplication` 선택 (없으면 새로 만들기)
3. `Environment variables` 클릭
4. `+` 버튼으로 추가:
   - Name: `OPENAI_API_KEY`
   - Value: `sk-your-api-key-here`
5. `OK` 클릭

**방법 B: IDE 환경 변수 설정**

IntelliJ IDEA:
1. `Help` → `Edit Custom VM Options...`
2. 또는 `.zshrc` / `.bashrc`에 추가 (macOS/Linux)

### 단계 4: 실행

1. `SpringAiAppApplication.kt` 파일 열기
2. 메인 함수 옆의 실행 버튼(▶️) 클릭
3. 또는 `Run` → `Run 'SpringAiAppApplication'`

### 단계 5: 확인

콘솔에 다음과 같은 메시지가 표시되면 성공:

```
Started SpringAiAppApplication in X.XXX seconds
```

---

## 🎯 방법 2: 터미널에서 실행

### 단계 1: 디렉토리 이동

```bash
cd sample
```

### 단계 2: 환경 변수 설정

**macOS / Linux:**
```bash
export OPENAI_API_KEY="sk-your-api-key-here"
```

**Windows (PowerShell):**
```powershell
$env:OPENAI_API_KEY="sk-your-api-key-here"
```

**Windows (CMD):**
```cmd
set OPENAI_API_KEY=sk-your-api-key-here
```

### 단계 3: 프로젝트 빌드 (선택사항)

```bash
./gradlew build
```

### 단계 4: 애플리케이션 실행

```bash
./gradlew bootRun
```

또는:

```bash
./gradlew build
java -jar build/libs/spring-ai-app-0.0.1-SNAPSHOT.jar
```

### 단계 5: 확인

터미널에 다음과 같은 메시지가 표시되면 성공:

```
Started SpringAiAppApplication in X.XXX seconds
```

---

## 🧪 테스트하기

### 테스트 1: GET 요청 (브라우저)

브라우저에서 다음 URL 열기:
```
http://localhost:8080/api/chat/test
```

예상 결과: AI의 자기소개 메시지

### 테스트 2: POST 요청 (curl)

터미널에서:

```bash
curl -X POST http://localhost:8080/api/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "안녕하세요!"}'
```

예상 결과: JSON 형식의 응답
```json
{
  "message": "안녕하세요! 무엇을 도와드릴까요?"
}
```

### 테스트 3: Postman 사용

1. Postman 실행
2. 새 요청 생성
3. Method: `POST`
4. URL: `http://localhost:8080/api/chat`
5. Headers: `Content-Type: application/json`
6. Body (raw JSON):
```json
{
  "message": "Spring AI에 대해 설명해주세요"
}
```
7. Send 클릭

---

## 🔧 문제 해결

### 문제 1: API Key 오류

**증상:**
```
Error: API key not found or invalid
```

**해결책:**
1. 환경 변수 확인: `echo $OPENAI_API_KEY`
2. API Key가 올바른지 확인
3. 애플리케이션 재시작

### 문제 2: 포트 충돌

**증상:**
```
Port 8080 is already in use
```

**해결책 1: 다른 포트 사용**

`application.yml` 수정:
```yaml
server:
  port: 8081
```

**해결책 2: 사용 중인 프로세스 종료**

```bash
# 포트 사용 중인 프로세스 찾기
lsof -i :8080  # macOS/Linux
netstat -ano | findstr :8080  # Windows

# 프로세스 종료
kill -9 <PID>  # macOS/Linux
```

### 문제 3: 의존성 다운로드 실패

**증상:**
```
Could not resolve dependencies
```

**해결책:**
```bash
./gradlew clean build --refresh-dependencies
```

### 문제 4: Kotlin 컴파일 오류

**증상:**
```
Kotlin version mismatch
```

**해결책:**
1. `build.gradle.kts` 확인
2. Kotlin 버전 업데이트:
```kotlin
kotlin("jvm") version "1.9.24"
```

---

## 📊 실행 상태 확인

### 로그 확인

애플리케이션이 정상 실행되면 다음 로그가 표시됩니다:

```
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v3.3.0)

2024-XX-XX INFO  --- [main] SpringAiAppApplication : Starting SpringAiAppApplication
2024-XX-XX INFO  --- [main] SpringAiAppApplication : Started SpringAiAppApplication in X.XXX seconds
```

### 헬스 체크

애플리케이션이 실행 중인지 확인:

```bash
curl http://localhost:8080/api/chat/test
```

정상 응답이 오면 성공!

---

## ✅ 성공 확인

다음이 모두 작동하면 환경 구축이 완료된 것입니다:

- [ ] 애플리케이션이 정상적으로 시작됨
- [ ] GET `/api/chat/test` 요청이 작동함
- [ ] POST `/api/chat` 요청이 작동함
- [ ] AI가 응답을 생성함

---

## 🎉 다음 단계

환경 구축이 완료되었습니다! 이제 다음을 학습할 수 있습니다:

1. **2장: LLM과 대화하기 (ChatClient)** - ChatClient의 다양한 기능 학습
2. **3장: 프롬프트 엔지니어링** - 효과적인 프롬프트 작성
3. **4장: 응답 구조화** - JSON 등 구조화된 데이터 추출

행운을 빕니다! 🚀

