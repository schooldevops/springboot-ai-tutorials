# ë¦¬ìŠ¤íŠ¸ ë° ë§µ íŒŒì‹± ìƒ˜í”Œ í”„ë¡œì íŠ¸ ì‹¤í–‰ ê°€ì´ë“œ

ì´ ê°€ì´ë“œëŠ” 4.2.ParseListAndMap ìƒ˜í”Œ í”„ë¡œì íŠ¸ë¥¼ ì‹¤í–‰í•˜ê³  í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

## ğŸ“‹ ì‚¬ì „ ì¤€ë¹„ì‚¬í•­

- JDK 17 ì´ìƒ ì„¤ì¹˜
- OpenAI API Key ë°œê¸‰
- í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ê¶Œí•œ

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

í„°ë¯¸ë„ì—ì„œ API Keyë¥¼ í™˜ê²½ ë³€ìˆ˜ë¡œ ì„¤ì •:

**macOS / Linux:**
```bash
export OPENAI_API_KEY="sk-your-api-key-here"
```

**Windows (PowerShell):**
```powershell
$env:OPENAI_API_KEY="sk-your-api-key-here"
```

### 2. í”„ë¡œì íŠ¸ ì‹¤í–‰

```bash
./gradlew bootRun
```

ë˜ëŠ” IntelliJ IDEAì—ì„œ `ListMapParserApplication.kt` ì‹¤í–‰

### 3. ì‹¤í–‰ í™•ì¸

ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì •ìƒì ìœ¼ë¡œ ì‹œì‘ë˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤:

```
Started ListMapParserApplication in X.XXX seconds
```

## ğŸ§ª API í…ŒìŠ¤íŠ¸

### ë¦¬ìŠ¤íŠ¸ íŒŒì‹± ì˜ˆì œ

#### 1. ê¸°ë³¸ ë¦¬ìŠ¤íŠ¸ íŒŒì‹±

```bash
curl -X POST http://localhost:8080/api/list-parser/parse \
  -H "Content-Type: application/json" \
  -d '{
    "question": "5ê°€ì§€ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ë‚˜ì—´í•´ì£¼ì„¸ìš”"
  }'
```

**ì˜ˆìƒ ì‘ë‹µ:**
```json
{
  "items": [
    "Python",
    "Java",
    "JavaScript",
    "Kotlin",
    "Go"
  ],
  "count": 5
}
```

#### 2. CSV í˜•ì‹ íŒŒì‹±

```bash
curl -X POST http://localhost:8080/api/list-parser/csv \
  -H "Content-Type: application/json" \
  -d '{
    "question": "5ê°€ì§€ í”„ë ˆì„ì›Œí¬ë¥¼ ì‰¼í‘œë¡œ êµ¬ë¶„í•˜ì—¬ ë‚˜ì—´í•´ì£¼ì„¸ìš”"
  }'
```

#### 3. ì•ˆì „í•œ ë¦¬ìŠ¤íŠ¸ íŒŒì‹±

```bash
curl -X POST http://localhost:8080/api/list-parser/safe \
  -H "Content-Type: application/json" \
  -d '{
    "question": "3ê°€ì§€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë‚˜ì—´í•´ì£¼ì„¸ìš”"
  }'
```

### ë§µ íŒŒì‹± ì˜ˆì œ

#### 4. ê¸°ë³¸ ë§µ íŒŒì‹±

```bash
curl -X POST http://localhost:8080/api/map-parser/parse \
  -H "Content-Type: application/json" \
  -d '{
    "question": "í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë³„ íŠ¹ì§•ì„ Key-Value í˜•ì‹ìœ¼ë¡œ ì œê³µí•´ì£¼ì„¸ìš”"
  }'
```

**ì˜ˆìƒ ì‘ë‹µ:**
```json
{
  "data": {
    "Python": "ê°„ê²°í•˜ê³  ì½ê¸° ì‰¬ìš´ ë¬¸ë²•",
    "Java": "í”Œë«í¼ ë…ë¦½ì , ê°ì²´ì§€í–¥",
    "JavaScript": "ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰, ë™ì  íƒ€ì…"
  },
  "count": 3
}
```

#### 5. ì•ˆì „í•œ ë§µ íŒŒì‹±

```bash
curl -X POST http://localhost:8080/api/map-parser/safe \
  -H "Content-Type: application/json" \
  -d '{
    "question": "í”„ë ˆì„ì›Œí¬ë³„ ì¥ì ì„ Key-Value í˜•ì‹ìœ¼ë¡œ ì œê³µí•´ì£¼ì„¸ìš”"
  }'
```

### ë³µí•© í˜•ì‹ íŒŒì‹± ì˜ˆì œ

#### 6. ë¦¬ìŠ¤íŠ¸ì™€ ë§µ ì¡°í•©

```bash
curl -X POST http://localhost:8080/api/complex-parser/combined \
  -H "Content-Type: application/json" \
  -d '{
    "question": "í”„ë¡œê·¸ë˜ë° ì–¸ì–´ ì¹´í…Œê³ ë¦¬ë¥¼ ë‚˜ì—´í•˜ê³ , ê° ì–¸ì–´ì˜ íŠ¹ì§•ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”"
  }'
```

**ì˜ˆìƒ ì‘ë‹µ:**
```json
{
  "categories": [
    "Python",
    "Java",
    "JavaScript"
  ],
  "details": {
    "Python": "ê°„ê²°í•œ ë¬¸ë²•",
    "Java": "í”Œë«í¼ ë…ë¦½ì ",
    "JavaScript": "ë¸Œë¼ìš°ì € ì‹¤í–‰"
  },
  "categoryCount": 3,
  "detailCount": 3
}
```

#### 7. êµ¬ì¡°í™”ëœ ì¹´í…Œê³ ë¦¬ë³„ ë°ì´í„°

```bash
curl -X POST http://localhost:8080/api/complex-parser/structured \
  -H "Content-Type: application/json" \
  -d '{
    "question": "í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ì¹´í…Œê³ ë¦¬ë³„ë¡œ í”„ë ˆì„ì›Œí¬ë¥¼ ë‚˜ì—´í•´ì£¼ì„¸ìš”"
  }'
```

**ì˜ˆìƒ ì‘ë‹µ:**
```json
{
  "categories": [
    {
      "name": "í”„ë¡ íŠ¸ì—”ë“œ",
      "items": ["React", "Vue", "Angular"],
      "itemCount": 3
    },
    {
      "name": "ë°±ì—”ë“œ",
      "items": ["Spring", "Express", "Django"],
      "itemCount": 3
    }
  ],
  "totalCategories": 2
}
```

## ğŸ“Š Postman ì‚¬ìš©

Postmanì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°:

### Collection ì˜ˆì‹œ

**1. ê¸°ë³¸ ë¦¬ìŠ¤íŠ¸ íŒŒì‹±**
- Method: POST
- URL: `http://localhost:8080/api/list-parser/parse`
- Body (JSON):
```json
{
  "question": "5ê°€ì§€ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ë‚˜ì—´í•´ì£¼ì„¸ìš”"
}
```

**2. ê¸°ë³¸ ë§µ íŒŒì‹±**
- Method: POST
- URL: `http://localhost:8080/api/map-parser/parse`
- Body:
```json
{
  "question": "í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë³„ íŠ¹ì§•ì„ Key-Value í˜•ì‹ìœ¼ë¡œ ì œê³µí•´ì£¼ì„¸ìš”"
}
```

## ğŸ” ë””ë²„ê¹…

### ë¡œê·¸ í™•ì¸

ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œ ë¡œê·¸ë¥¼ í™•ì¸í•˜ì—¬ ë””ë²„ê¹…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```yaml
# application.ymlì— ì´ë¯¸ ì„¤ì •ë¨
logging:
  level:
    com.example.springai: DEBUG
    org.springframework.ai: DEBUG
```

### íŒŒì‹± ê²°ê³¼ ë””ë²„ê¹…

ì½”ë“œì— ë¡œê·¸ë¥¼ ì¶”ê°€í•˜ì—¬ íŒŒì‹± ê³¼ì •ì„ í™•ì¸:

```kotlin
val response = chatModel.call(prompt)
val text = response.results.firstOrNull()?.output?.text ?: ""
println("Raw response: $text")  // ë””ë²„ê¹…ìš©

val items = parser.parse(text)
println("Parsed items: $items")  // ë””ë²„ê¹…ìš©
```

## âŒ ë¬¸ì œ í•´ê²°

### ë¬¸ì œ 1: ë¹ˆ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜

**ì¦ìƒ:**
```
íŒŒì‹± ê²°ê³¼ê°€ ë¹ˆ ë¦¬ìŠ¤íŠ¸
```

**ì›ì¸**: LLMì´ ì§€ì •ëœ í˜•ì‹ì„ ë”°ë¥´ì§€ ì•ŠìŒ

**í•´ê²°ì±…:**
1. Format ë©”ì‹œì§€ë¥¼ ë” ëª…í™•í•˜ê²Œ ì „ë‹¬
2. ì˜ˆì‹œë¥¼ í¬í•¨í•˜ì—¬ í˜•ì‹ ì„¤ëª…
3. ì—ëŸ¬ ì²˜ë¦¬ í¬í•¨ëœ `/safe` ì—”ë“œí¬ì¸íŠ¸ ì‚¬ìš©

### ë¬¸ì œ 2: êµ¬ë¶„ì ì¸ì‹ ì‹¤íŒ¨

**ì¦ìƒ:**
```
ë¦¬ìŠ¤íŠ¸ê°€ í•˜ë‚˜ì˜ í•­ëª©ìœ¼ë¡œ íŒŒì‹±ë¨
```

**ì›ì¸**: LLMì´ ë‹¤ë¥¸ êµ¬ë¶„ìë¥¼ ì‚¬ìš©

**í•´ê²°ì±…:**
- Format ë©”ì‹œì§€ì— êµ¬ë¶„ìë¥¼ ëª…í™•íˆ ëª…ì‹œ
- ì˜ˆì‹œë¥¼ í¬í•¨í•˜ì—¬ í˜•ì‹ ì„¤ëª…

### ë¬¸ì œ 3: ë§µ íŒŒì‹± ì‹¤íŒ¨

**ì¦ìƒ:**
```
Mapì´ ë¹„ì–´ìˆê±°ë‚˜ í‚¤-ê°’ ìŒì´ ëˆ„ë½ë¨
```

**í•´ê²°ì±…:**
- Format ë©”ì‹œì§€ì— Key-Value í˜•ì‹ ì˜ˆì‹œ í¬í•¨
- ì½œë¡ (:) ì•ì´ Key, ë’¤ê°€ Valueì„ì„ ëª…í™•íˆ ì„¤ëª…

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

ì‹¤í–‰ ì „ í™•ì¸ì‚¬í•­:

- [ ] JDK 17 ì´ìƒ ì„¤ì¹˜ë¨
- [ ] OpenAI API Key ë°œê¸‰ë¨
- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì •ë¨
- [ ] í”„ë¡œì íŠ¸ ë¹Œë“œ ì„±ê³µ (`./gradlew build`)
- [ ] ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì„±ê³µ (`./gradlew bootRun`)
- [ ] API ì—”ë“œí¬ì¸íŠ¸ ì‘ë‹µ í™•ì¸

## ğŸ“ í•™ìŠµ ê¶Œì¥ ìˆœì„œ

1. **ë¦¬ìŠ¤íŠ¸ íŒŒì‹±**: `/api/list-parser/*` ì—”ë“œí¬ì¸íŠ¸ë“¤
2. **ë§µ íŒŒì‹±**: `/api/map-parser/*` ì—”ë“œí¬ì¸íŠ¸ë“¤
3. **ë³µí•© í˜•ì‹**: `/api/complex-parser/*` ì—”ë“œí¬ì¸íŠ¸ë“¤
4. **ì½”ë“œ ë¶„ì„**: ListOutputParserì™€ MapOutputParser êµ¬í˜„ í™•ì¸

## ğŸ“š í•µì‹¬ ê°œë… ì •ë¦¬

### ListOutputParser ì‚¬ìš© íŒ¨í„´

```kotlin
// 1. Parser ìƒì„±
val parser = ListOutputParser()
val format = parser.format

// 2. Prompt ìƒì„± (Format í¬í•¨)
val prompt = Prompt(
    listOf(
        SystemMessage("ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”:\n$format"),
        UserMessage("í•­ëª©ì„ ë‚˜ì—´í•´ì£¼ì„¸ìš”")
    )
)

// 3. LLM í˜¸ì¶œ
val response = chatModel.call(prompt)
val text = response.results.firstOrNull()?.output?.text ?: ""

// 4. íŒŒì‹±
val items: List<String> = parser.parse(text)
```

### MapOutputParser ì‚¬ìš© íŒ¨í„´

```kotlin
// 1. Parser ìƒì„±
val parser = MapOutputParser()
val format = parser.format

// 2. Prompt ìƒì„± (Format í¬í•¨)
val prompt = Prompt(
    listOf(
        SystemMessage("ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”:\n$format"),
        UserMessage("Key-Value ìŒì„ ì œê³µí•´ì£¼ì„¸ìš”")
    )
)

// 3. LLM í˜¸ì¶œ
val response = chatModel.call(prompt)
val text = response.results.firstOrNull()?.output?.text ?: ""

// 4. íŒŒì‹±
val map: Map<String, String> = parser.parse(text)
```

### êµ¬ë¶„ì ì„ íƒ

```kotlin
// ì¤„ë°”ê¿ˆ êµ¬ë¶„ì (ê¸°ë³¸)
val parser = ListOutputParser()  // separator = "\n"

// ì‰¼í‘œ êµ¬ë¶„ì (CSV)
val csvParser = ListOutputParser(separator = ",")

// ì„¸ë¯¸ì½œë¡  êµ¬ë¶„ì
val semicolonParser = ListOutputParser(separator = ";")
```

---

**ë‹¤ìŒ í•™ìŠµ**: [5.1: ì„ë² ë”©ì˜ ê°œë…ê³¼ EmbeddingClient](../../README.md#51-ì„ë² ë”©ì˜-ê°œë…ê³¼-embeddingclient)

