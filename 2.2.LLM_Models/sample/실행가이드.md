# LLM ëª¨ë¸ ì—°ë™ ìƒ˜í”Œ í”„ë¡œì íŠ¸ ì‹¤í–‰ ê°€ì´ë“œ

ì´ ê°€ì´ë“œëŠ” ë‹¤ì–‘í•œ LLM ëª¨ë¸ì„ ì—°ë™í•˜ëŠ” ìƒ˜í”Œ í”„ë¡œì íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

## ğŸ“‹ ì‚¬ì „ ì¤€ë¹„ì‚¬í•­

### ê¸°ë³¸ ì¤€ë¹„
- JDK 17 ì´ìƒ
- Gradle ì„¤ì¹˜ (ë˜ëŠ” Gradle Wrapper ì‚¬ìš©)

### LLMë³„ ì¤€ë¹„ì‚¬í•­

#### OpenAI ì‚¬ìš© ì‹œ
- OpenAI API Key ë°œê¸‰: https://platform.openai.com/

#### Anthropic ì‚¬ìš© ì‹œ
- Anthropic API Key ë°œê¸‰: https://console.anthropic.com/

#### Ollama ì‚¬ìš© ì‹œ
- Ollama ì„¤ì¹˜:
  ```bash
  # macOS
  brew install ollama
  
  # Linux
  curl -fsSL https://ollama.ai/install.sh | sh
  ```
- Ollama ì„œë²„ ì‹¤í–‰:
  ```bash
  ollama serve
  ```
- ëª¨ë¸ ë‹¤ìš´ë¡œë“œ:
  ```bash
  ollama pull llama2
  # ë˜ëŠ”
  ollama pull mistral
  ```

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### ì‹œë‚˜ë¦¬ì˜¤ 1: OpenAIë§Œ ì‚¬ìš© (ê¸°ë³¸)

#### 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```bash
export OPENAI_API_KEY="sk-your-api-key-here"
```

#### 2. ì‹¤í–‰

```bash
./gradlew bootRun
```

#### 3. í…ŒìŠ¤íŠ¸

```bash
# ê¸°ë³¸ í…ŒìŠ¤íŠ¸
curl http://localhost:8080/api/openai/test

# ì±„íŒ…
curl -X POST http://localhost:8080/api/openai/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "Spring AIì— ëŒ€í•´ ì„¤ëª…í•´ì£¼ì„¸ìš”"}'
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: Ollama ì¶”ê°€ ì‚¬ìš© (ì—¬ëŸ¬ ëª¨ë¸)

#### 1. Ollama ì„œë²„ ì‹¤í–‰

```bash
ollama serve
```

#### 2. build.gradle.kts ìˆ˜ì •

Ollama ì˜ì¡´ì„± ì£¼ì„ í•´ì œ:
```kotlin
implementation("org.springframework.ai:spring-ai-ollama-spring-boot-starter:1.0.0-M6")
```

#### 3. application.yml ìˆ˜ì •

Ollama ì„¤ì • ì£¼ì„ í•´ì œ:
```yaml
spring:
  ai:
    ollama:
      base-url: http://localhost:11434
      chat:
        options:
          model: llama2
```

#### 4. í”„ë¡œì íŠ¸ ì¬ë¹Œë“œ

```bash
./gradlew clean build
./gradlew bootRun
```

#### 5. í…ŒìŠ¤íŠ¸

```bash
# ê¸°ë³¸ ëª¨ë¸ (OpenAI)
curl "http://localhost:8080/api/multi/default?message=ì•ˆë…•í•˜ì„¸ìš”"

# Ollama ëª¨ë¸
curl "http://localhost:8080/api/multi/ollama?message=ì•ˆë…•í•˜ì„¸ìš”"

# ë‘ ëª¨ë¸ ë¹„êµ
curl "http://localhost:8080/api/multi/compare?message=Spring AIì— ëŒ€í•´ ì„¤ëª…í•´ì£¼ì„¸ìš”"

# ìŠ¤ë§ˆíŠ¸ ëª¨ë¸ ì„ íƒ
curl -X POST http://localhost:8080/api/smart/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "ì•ˆë…•í•˜ì„¸ìš”"}'

# ë¹„ìš© ìµœì í™” ëª¨ë¸ ì„ íƒ
curl -X POST http://localhost:8080/api/smart/cost-optimized \
  -H "Content-Type: application/json" \
  -d '{"message": "ê°ì‚¬í•©ë‹ˆë‹¤"}'
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: Ollamaë§Œ ì‚¬ìš© (ë¬´ë£Œ)

#### 1. build.gradle.kts ìˆ˜ì •

OpenAI ì˜ì¡´ì„± ì£¼ì„ ì²˜ë¦¬, Ollama ì˜ì¡´ì„± í™œì„±í™”:
```kotlin
// implementation("org.springframework.ai:spring-ai-openai-spring-boot-starter:1.0.0-M6")
implementation("org.springframework.ai:spring-ai-ollama-spring-boot-starter:1.0.0-M6")
```

#### 2. application.yml ìˆ˜ì •

Ollama ì„¤ì •ë§Œ í™œì„±í™”:
```yaml
spring:
  ai:
    ollama:
      base-url: http://localhost:11434
      chat:
        options:
          model: llama2
```

ë˜ëŠ” í”„ë¡œíŒŒì¼ ì‚¬ìš©:
```bash
./gradlew bootRun --args='--spring.profiles.active=ollama'
```

---

## ğŸ§ª API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸

### OpenAI ì „ìš©

#### GET /api/openai/test
```bash
curl http://localhost:8080/api/openai/test
```

#### POST /api/openai/chat
```bash
curl -X POST http://localhost:8080/api/openai/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "Kotlinì˜ ì£¼ìš” íŠ¹ì§•ì€?"}'
```

### ì—¬ëŸ¬ ëª¨ë¸ ì‚¬ìš©

#### GET /api/multi/default
ê¸°ë³¸ ëª¨ë¸ (OpenAI) ì‚¬ìš©:
```bash
curl "http://localhost:8080/api/multi/default?message=ì•ˆë…•í•˜ì„¸ìš”"
```

#### GET /api/multi/ollama
Ollama ëª¨ë¸ ì‚¬ìš© (Ollamaê°€ ì„¤ì •ëœ ê²½ìš°):
```bash
curl "http://localhost:8080/api/multi/ollama?message=ì•ˆë…•í•˜ì„¸ìš”"
```

#### GET /api/multi/compare
ë‘ ëª¨ë¸ ë¹„êµ:
```bash
curl "http://localhost:8080/api/multi/compare?message=Spring AIì— ëŒ€í•´ ì„¤ëª…í•´ì£¼ì„¸ìš”"
```

**ì˜ˆìƒ ì‘ë‹µ:**
```json
{
  "default": {
    "model": "Primary",
    "message": "Spring AIëŠ”..."
  },
  "ollama": {
    "model": "Ollama",
    "message": "Spring AIëŠ”..."
  }
}
```

### ìŠ¤ë§ˆíŠ¸ ëª¨ë¸ ì„ íƒ

#### POST /api/smart/chat
ì§ˆë¬¸ ë³µì¡ë„ì— ë”°ë¼ ëª¨ë¸ ìë™ ì„ íƒ:
```bash
curl -X POST http://localhost:8080/api/smart/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "ì•ˆë…•í•˜ì„¸ìš”"}'
```

**ì˜ˆìƒ ì‘ë‹µ:**
```json
{
  "selectedModel": "Ollama",
  "message": "ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?",
  "questionLength": 5
}
```

#### POST /api/smart/cost-optimized
ë¹„ìš© ìµœì í™”ë¥¼ ìœ„í•œ ëª¨ë¸ ì„ íƒ:
```bash
curl -X POST http://localhost:8080/api/smart/cost-optimized \
  -H "Content-Type: application/json" \
  -d '{"message": "ê°ì‚¬í•©ë‹ˆë‹¤"}'
```

---

## ğŸ“Š Postman Collection

Postmanì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°:

### 1. OpenAI í…ŒìŠ¤íŠ¸

**Request 1: Basic Test**
- Method: GET
- URL: `http://localhost:8080/api/openai/test`

**Request 2: Chat**
- Method: POST
- URL: `http://localhost:8080/api/openai/chat`
- Body (JSON):
```json
{
  "message": "Spring AIì— ëŒ€í•´ ì„¤ëª…í•´ì£¼ì„¸ìš”"
}
```

### 2. ì—¬ëŸ¬ ëª¨ë¸ ë¹„êµ

**Request: Compare Models**
- Method: GET
- URL: `http://localhost:8080/api/multi/compare?message=Spring AIì— ëŒ€í•´ ì„¤ëª…í•´ì£¼ì„¸ìš”`

---

## ğŸ” í™•ì¸ ì‚¬í•­

### OpenAI í™•ì¸

```bash
# í™˜ê²½ ë³€ìˆ˜ í™•ì¸
echo $OPENAI_API_KEY

# API í…ŒìŠ¤íŠ¸
curl http://localhost:8080/api/openai/test
```

### Ollama í™•ì¸

```bash
# Ollama ì„œë²„ ì‹¤í–‰ í™•ì¸
curl http://localhost:11434/api/tags

# ë‹¤ìš´ë¡œë“œëœ ëª¨ë¸ í™•ì¸
ollama list

# API í…ŒìŠ¤íŠ¸
curl http://localhost:8080/api/multi/ollama?message=test
```

---

## âŒ ë¬¸ì œ í•´ê²°

### ë¬¸ì œ 1: OpenAI API Key ì˜¤ë¥˜

**ì¦ìƒ:**
```
Invalid API Key
```

**í•´ê²°ì±…:**
```bash
# í™˜ê²½ ë³€ìˆ˜ í™•ì¸
echo $OPENAI_API_KEY

# ì˜¬ë°”ë¥¸ í‚¤ ì„¤ì •
export OPENAI_API_KEY="sk-..."
```

### ë¬¸ì œ 2: Ollama ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ:**
```
Connection refused: localhost:11434
```

**í•´ê²°ì±…:**
```bash
# Ollama ì„œë²„ ì‹œì‘
ollama serve

# ì„œë²„ ìƒíƒœ í™•ì¸
curl http://localhost:11434/api/tags
```

### ë¬¸ì œ 3: ì—¬ëŸ¬ ChatModel Bean ì¶©ëŒ

**ì¦ìƒ:**
```
NoUniqueBeanDefinitionException
```

**í•´ê²°ì±…:**
- OpenAIëŠ” ìë™ìœ¼ë¡œ @Primaryë¡œ ì„¤ì •ë¨
- OllamaëŠ” @Qualifierë¡œ ì„ íƒ
- í•„ìš”ì‹œ ëª…ì‹œì ìœ¼ë¡œ @Primary ì§€ì •

### ë¬¸ì œ 4: ëª¨ë¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ (Ollama)

**ì¦ìƒ:**
```
Model not found: llama2
```

**í•´ê²°ì±…:**
```bash
# ëª¨ë¸ ë‹¤ìš´ë¡œë“œ
ollama pull llama2

# ë‹¤ìš´ë¡œë“œëœ ëª¨ë¸ í™•ì¸
ollama list
```

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

ì‹¤í–‰ ì „ í™•ì¸:

### ê¸°ë³¸
- [ ] JDK 17 ì´ìƒ ì„¤ì¹˜ë¨
- [ ] í”„ë¡œì íŠ¸ ë¹Œë“œ ì„±ê³µ (`./gradlew build`)
- [ ] ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì„±ê³µ

### OpenAI ì‚¬ìš© ì‹œ
- [ ] OpenAI API Key ë°œê¸‰ë¨
- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì •ë¨ (`export OPENAI_API_KEY`)
- [ ] API ì—”ë“œí¬ì¸íŠ¸ ì‘ë‹µ í™•ì¸

### Ollama ì‚¬ìš© ì‹œ
- [ ] Ollama ì„¤ì¹˜ë¨
- [ ] Ollama ì„œë²„ ì‹¤í–‰ ì¤‘ (`ollama serve`)
- [ ] ëª¨ë¸ ë‹¤ìš´ë¡œë“œë¨ (`ollama pull llama2`)
- [ ] build.gradle.ktsì— Ollama ì˜ì¡´ì„± ì¶”ê°€ë¨
- [ ] application.ymlì— Ollama ì„¤ì • ì¶”ê°€ë¨
- [ ] Ollama API ì—”ë“œí¬ì¸íŠ¸ ì‘ë‹µ í™•ì¸

---

## ğŸ“ í•™ìŠµ ì‹œë‚˜ë¦¬ì˜¤

### ë‹¨ê³„ 1: OpenAI ê¸°ë³¸ ì‚¬ìš©
1. OpenAIë§Œ ì„¤ì •
2. `/api/openai/*` ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
3. ì‘ë‹µ í™•ì¸

### ë‹¨ê³„ 2: Ollama ì¶”ê°€
1. Ollama ì„¤ì¹˜ ë° ì‹¤í–‰
2. build.gradle.kts ìˆ˜ì •
3. application.yml ìˆ˜ì •
4. `/api/multi/*` ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸

### ë‹¨ê³„ 3: ì—¬ëŸ¬ ëª¨ë¸ ë¹„êµ
1. ë‘ ëª¨ë¸ ë™ì‹œ ì‹¤í–‰
2. `/api/multi/compare`ë¡œ ë¹„êµ
3. ì‘ë‹µ ì°¨ì´ í™•ì¸

### ë‹¨ê³„ 4: ìŠ¤ë§ˆíŠ¸ ëª¨ë¸ ì„ íƒ
1. `/api/smart/*` ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
2. ëª¨ë¸ ì„ íƒ ë¡œì§ í™•ì¸
3. ë¹„ìš© ìµœì í™” ì „ëµ ì´í•´

---

## ğŸ“š ë‹¤ìŒ ë‹¨ê³„

ì´ ìƒ˜í”Œ í”„ë¡œì íŠ¸ë¥¼ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰í–ˆë‹¤ë©´:

1. âœ… ë‹¤ì–‘í•œ LLM ëª¨ë¸ì„ ì—°ë™í•˜ëŠ” ë°©ë²•ì„ ì´í•´í–ˆìŠµë‹ˆë‹¤
2. âœ… ì—¬ëŸ¬ ëª¨ë¸ì„ ë™ì‹œì— ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤
3. âœ… ìƒí™©ì— ë”°ë¼ ì ì ˆí•œ ëª¨ë¸ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
4. âœ… ë‹¤ìŒ ì¥ìœ¼ë¡œ ì§„í–‰í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤!

**ë‹¤ìŒ í•™ìŠµ**: [3ì¥: íš¨ê³¼ì ì¸ í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§](../../README.md#3ì¥-íš¨ê³¼ì ì¸-í”„ë¡¬í”„íŠ¸-ì—”ì§€ë‹ˆì–´ë§-prompttemplate)

